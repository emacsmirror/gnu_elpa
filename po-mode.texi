\input texinfo          @c -*-texinfo-*-
@c %**start of header
@setfilename po-mode.info
@c The @ifset makeinfo ... @end ifset conditional evaluates to true in makeinfo
@c for info and html output, but to false in texi2html.
@ifnottex
@ifclear texi2html
@set makeinfo
@end ifclear
@end ifnottex
@c The @documentencoding is needed for makeinfo; texi2html 1.52
@c doesn't recognize it.
@ifset makeinfo
@documentencoding UTF-8
@end ifset
@settitle PO Mode

@c Remove the black boxes generated in the GPL appendix.
@finalout

@c In PDF output, use a brown colour for interactive links,
@c like it was before commit
@c https://git.savannah.gnu.org/gitweb/?p=texinfo.git;a=commitdiff;h=b4f50b9f4c083327e81ec5c7cde9b87234a19646
@tex
\global\def\linkcolor{\rgbDarkRed}
\global\def\urlcolor{\rgbDarkRed}
@end tex

@c Indices:
@c   cp = concept         @cindex
@c   ef = emacs function  @efindex
@c   em = emacs mode      @emindex
@c   ev = emacs variable  @evindex
@c Unused predefined indices:
@c   fn = function        @findex
@c   ky = keystroke       @kindex
@c   pg = program         @pindex
@c   tp = type            @tindex
@c   vr = variable        @vindex
@defcodeindex ef
@defindex em
@defcodeindex ev
@syncodeindex ef em
@syncodeindex ev em

@ifclear texi2html
@firstparagraphindent insert
@end ifclear
@c %**end of header

@set UPDATED 16 February 2026
@set VERSION 2.32

@ifinfo
@dircategory Emacs
@direntry
* po-mode: (po-mode).                          Emacs PO Mode.
@end direntry
@end ifinfo

@ifinfo
This file provides documentation for the Emacs PO mode.

@copying
Copyright (C) 1995-1998, 2001-2026 Free Software Foundation, Inc.

This manual is free documentation.  It is dually licensed under the
GNU FDL and the GNU GPL.  This means that you can redistribute this
manual under either of these two licenses, at your choice.

This manual is covered by the GNU FDL.  Permission is granted to copy,
distribute and/or modify this document under the terms of the
GNU Free Documentation License (FDL), either version 1.2 of the
License, or (at your option) any later version published by the
Free Software Foundation (FSF); with no Invariant Sections, with no
Front-Cover Text, and with no Back-Cover Texts.
A copy of the license is included in @ref{GNU FDL}.

This manual is covered by the GNU GPL.  You can redistribute it and/or
modify it under the terms of the GNU General Public License (GPL), either
version 2 of the License, or (at your option) any later version published
by the Free Software Foundation (FSF).
A copy of the license is included in @ref{GNU GPL}.
@end copying
@end ifinfo

@titlepage
@title Emacs PO Mode
@subtitle Version @value{VERSION}, @value{UPDATED}
@author Ulrich Drepper
@author Jim Meyering
@author Fran@,{c}ois Pinard
@author Bruno Haible

@ifnothtml
@page
@vskip 0pt plus 1filll
@c @insertcopying
Copyright (C) 1995-1998, 2001-2026 Free Software Foundation, Inc.

This manual is free documentation.  It is dually licensed under the
GNU FDL and the GNU GPL.  This means that you can redistribute this
manual under either of these two licenses, at your choice.

This manual is covered by the GNU FDL.  Permission is granted to copy,
distribute and/or modify this document under the terms of the
GNU Free Documentation License (FDL), either version 1.2 of the
License, or (at your option) any later version published by the
Free Software Foundation (FSF); with no Invariant Sections, with no
Front-Cover Text, and with no Back-Cover Texts.
A copy of the license is included in @ref{GNU FDL}.

This manual is covered by the GNU GPL.  You can redistribute it and/or
modify it under the terms of the GNU General Public License (GPL), either
version 2 of the License, or (at your option) any later version published
by the Free Software Foundation (FSF).
A copy of the license is included in @ref{GNU GPL}.
@end ifnothtml
@end titlepage

@iftex
@c Table of Contents
@contents
@end iftex

@ifnottex
@node Top
@top Emacs PO Mode

This manual documents the Emacs PO mode, version @value{VERSION}.

@c Table of Contents
@contents

@menu
* Overview::                    Overview
* Translators::                 PO mode for translators
* Programmers::                 PO mode for programmers

* Licenses::                    Licenses

* PO Mode Index::               Index of Emacs PO Mode Commands
* Index::                       General Index

@detailmenu
 --- The Detailed Node Listing ---

Translators

* Editing PO files::            Emacs's PO File Editor

Editing PO files

* Installation::                Completing GNU @code{gettext} Installation
* Main PO Commands::            Main Commands
* Entry Positioning::           Entry Positioning
* Normalizing::                 Normalizing Strings in Entries
* Translated Entries::          Translated Entries
* Fuzzy Entries::               Fuzzy Entries
* Untranslated Entries::        Untranslated Entries
* Obsolete Entries::            Obsolete Entries
* Modifying Translations::      Modifying Translations
* Modifying Comments::          Modifying Comments
* Subedit::                     Mode for Editing Translations
* C Sources Context::           C Sources Context
* Auxiliary::                   Consulting Auxiliary PO Files

Programmers

* Marking::                     Marking Translatable Strings

Licenses

* GNU GPL::                     GNU General Public License
* GNU FDL::                     GNU Free Documentation License

@end detailmenu
@end menu

@end ifnottex

@node Overview
@chapter Overview

A @emph{PO file} contains
translations of messages that a program might show to the user,
for a specific language (or, in some cases, for a dialect of a language).

The Emacs PO mode is an editor for PO files,
implemented as an Emacs mode.

@cindex bug report address
Please submit suggestions and corrections
@itemize @bullet
@item
either in the bug tracker at @url{https://savannah.gnu.org/projects/gettext}
@item
or by email to @code{bug-gettext@@gnu.org}.
@end itemize

@noindent
Please include the manual's edition number and update date in your messages.

@node Translators
@chapter PO mode for translators

The PO mode is the PO file editor for translators who use Emacs.

@menu
* Editing PO files::            Emacs's PO File Editor
@end menu

@node Editing PO files
@section Emacs's PO File Editor

@c FIXME: Rewrite.

For those of you being
the lucky users of Emacs, PO mode has been specifically created
for providing a cozy environment for editing or modifying PO files.
While editing a PO file, PO mode allows for the easy browsing of
auxiliary and compendium PO files, as well as for following references into
the set of C program sources from which PO files have been derived.
It has a few special features, among which are the interactive marking
of program strings as translatable, and the validation of PO files
with easy repositioning to PO file lines showing errors.

For the beginning, besides main PO mode commands
(@pxref{Main PO Commands}), you should know how to move between entries
(@pxref{Entry Positioning}), and how to handle untranslated entries
(@pxref{Untranslated Entries}).

@menu
* Installation::                Completing GNU @code{gettext} Installation
* Main PO Commands::            Main Commands
* Entry Positioning::           Entry Positioning
* Normalizing::                 Normalizing Strings in Entries
* Translated Entries::          Translated Entries
* Fuzzy Entries::               Fuzzy Entries
* Untranslated Entries::        Untranslated Entries
* Obsolete Entries::            Obsolete Entries
* Modifying Translations::      Modifying Translations
* Modifying Comments::          Modifying Comments
* Subedit::                     Mode for Editing Translations
* C Sources Context::           C Sources Context
* Auxiliary::                   Consulting Auxiliary PO Files
@end menu

@node Installation
@subsection Completing GNU @code{gettext} Installation

@cindex installing @code{gettext}
@cindex @code{gettext} installation
Once you have received, unpacked, configured and compiled the GNU
@code{gettext} distribution, the @samp{make install} command puts in
place the programs @code{xgettext}, @code{msgfmt}, @code{gettext}, and
@code{msgmerge}, as well as their available message catalogs.  To
top off a comfortable installation, you might also want to make the
PO mode available to your Emacs users.

@emindex @file{.emacs} customizations
@emindex installing PO mode
During the installation of the PO mode, you might want to modify your
file @file{.emacs}, once and for all, so it contains a few lines looking
like:

@example
(setq auto-mode-alist
      (cons '("\\.po\\'\\|\\.po\\." . po-mode) auto-mode-alist))
(autoload 'po-mode "po-mode" "Major mode for translators to edit PO files" t)
@end example

Later, whenever you edit some @file{.po}
file, or any file having the string @samp{.po.} within its name,
Emacs loads @file{po-mode.elc} (or @file{po-mode.el}) as needed, and
automatically activates PO mode commands for the associated buffer.
The string @emph{PO} appears in the mode line for any buffer for
which PO mode is active.  Many PO files may be active at once in a
single Emacs session.

If you are using Emacs version 20 or newer, and have already installed
the appropriate international fonts on your system, you may also tell
Emacs how to determine automatically the coding system of every PO file.
This will often (but not always) cause the necessary fonts to be loaded
and used for displaying the translations on your Emacs screen.  For this
to happen, add the lines:

@example
(modify-coding-system-alist 'file "\\.po\\'\\|\\.po\\."
                            'po-find-file-coding-system)
(autoload 'po-find-file-coding-system "po-mode")
@end example

@noindent
to your @file{.emacs} file.  If, with this, you still see boxes instead
of international characters, try a different font set (via Shift Mouse
button 1).

@node Main PO Commands
@subsection Main PO mode Commands

@cindex PO mode (Emacs) commands
@emindex commands
After setting up Emacs with something similar to the lines in
@ref{Installation}, PO mode is activated for a window when Emacs finds a
PO file in that window.  This puts the window read-only and establishes a
po-mode-map, which is a genuine Emacs mode, in a way that is not derived
from text mode in any way.  Functions found on @code{po-mode-hook},
if any, will be executed.

When PO mode is active in a window, the letters @samp{PO} appear
in the mode line for that window.  The mode line also displays how
many entries of each kind are held in the PO file.  For example,
the string @samp{132t+3f+10u+2o} would tell the translator that the
PO mode contains 132 translated entries (@pxref{Translated Entries},
3 fuzzy entries (@pxref{Fuzzy Entries}), 10 untranslated entries
(@pxref{Untranslated Entries}) and 2 obsolete entries (@pxref{Obsolete
Entries}).  Zero-coefficients items are not shown.  So, in this example, if
the fuzzy entries were unfuzzied, the untranslated entries were translated
and the obsolete entries were deleted, the mode line would merely display
@samp{145t} for the counters.

The main PO commands are those which do not fit into the other categories of
subsequent sections.  These allow for quitting PO mode or for managing windows
in special ways.

@table @kbd
@item _
@efindex _@r{, PO Mode command}
Undo last modification to the PO file (@code{po-undo}).

@item Q
@efindex Q@r{, PO Mode command}
Quit processing and save the PO file (@code{po-quit}).

@item q
@efindex q@r{, PO Mode command}
Quit processing, possibly after confirmation (@code{po-confirm-and-quit}).

@item 0
@efindex 0@r{, PO Mode command}
Temporary leave the PO file window (@code{po-other-window}).

@item ?
@itemx h
@efindex ?@r{, PO Mode command}
@efindex h@r{, PO Mode command}
Show help about PO mode (@code{po-help}).

@item =
@efindex =@r{, PO Mode command}
Give some PO file statistics (@code{po-statistics}).

@item V
@efindex V@r{, PO Mode command}
Batch validate the format of the whole PO file (@code{po-validate}).

@end table

@efindex _@r{, PO Mode command}
@efindex po-undo@r{, PO Mode command}
The command @kbd{_} (@code{po-undo}) interfaces to the Emacs
@emph{undo} facility.  @xref{Undo, , Undoing Changes, emacs, The Emacs
Editor}.  Each time @kbd{_} is typed, modifications which the translator
did to the PO file are undone a little more.  For the purpose of
undoing, each PO mode command is atomic.  This is especially true for
the @kbd{@key{RET}} command: the whole edition made by using a single
use of this command is undone at once, even if the edition itself
implied several actions.  However, while in the editing window, one
can undo the edition work quite parsimoniously.

@efindex Q@r{, PO Mode command}
@efindex q@r{, PO Mode command}
@efindex po-quit@r{, PO Mode command}
@efindex po-confirm-and-quit@r{, PO Mode command}
The commands @kbd{Q} (@code{po-quit}) and @kbd{q}
(@code{po-confirm-and-quit}) are used when the translator is done with the
PO file.  The former is a bit less verbose than the latter.  If the file
has been modified, it is saved to disk first.  In both cases, and prior to
all this, the commands check if any untranslated messages remain in the
PO file and, if so, the translator is asked if she really wants to leave
off working with this PO file.  This is the preferred way of getting rid
of an Emacs PO file buffer.  Merely killing it through the usual command
@w{@kbd{C-x k}} (@code{kill-buffer}) is not the tidiest way to proceed.

@efindex 0@r{, PO Mode command}
@efindex po-other-window@r{, PO Mode command}
The command @kbd{0} (@code{po-other-window}) is another, softer way,
to leave PO mode, temporarily.  It just moves the cursor to some other
Emacs window, and pops one if necessary.  For example, if the translator
just got PO mode to show some source context in some other, she might
discover some apparent bug in the program source that needs correction.
This command allows the translator to change sex, become a programmer,
and have the cursor right into the window containing the program she
(or rather @emph{he}) wants to modify.  By later getting the cursor back
in the PO file window, or by asking Emacs to edit this file once again,
PO mode is then recovered.

@efindex ?@r{, PO Mode command}
@efindex h@r{, PO Mode command}
@efindex po-help@r{, PO Mode command}
The command @kbd{h} (@code{po-help}) displays a summary of all available PO
mode commands.  The translator should then type any character to resume
normal PO mode operations.  The command @kbd{?} has the same effect
as @kbd{h}.

@efindex =@r{, PO Mode command}
@efindex po-statistics@r{, PO Mode command}
The command @kbd{=} (@code{po-statistics}) computes the total number of
entries in the PO file, the ordinal of the current entry (counted from
1), the number of untranslated entries, the number of obsolete entries,
and displays all these numbers.

@efindex V@r{, PO Mode command}
@efindex po-validate@r{, PO Mode command}
The command @kbd{V} (@code{po-validate}) launches @code{msgfmt} in
checking and verbose
mode over the current PO file.  This command first offers to save the
current PO file on disk.  The @code{msgfmt} tool, from GNU @code{gettext},
has the purpose of creating a MO file out of a PO file, and PO mode uses
the features of this program for checking the overall format of a PO file,
as well as all individual entries.

@efindex next-error@r{, stepping through PO file validation results}
The program @code{msgfmt} runs asynchronously with Emacs, so the
translator regains control immediately while her PO file is being studied.
Error output is collected in the Emacs @samp{*compilation*} buffer,
displayed in another window.  The regular Emacs command @kbd{C-x`}
(@code{next-error}), as well as other usual compile commands, allow the
translator to reposition quickly to the offending parts of the PO file.
Once the cursor is on the line in error, the translator may decide on
any PO mode action which would help correcting the error.

@node Entry Positioning
@subsection Entry Positioning

@emindex current entry of a PO file
The cursor in a PO file window is almost always part of
an entry.  The only exceptions are the special case when the cursor
is after the last entry in the file, or when the PO file is
empty.  The entry where the cursor is found to be is said to be the
current entry.  Many PO mode commands operate on the current entry,
so moving the cursor does more than allowing the translator to browse
the PO file, this also selects on which entry commands operate.

@emindex moving through a PO file
Some PO mode commands alter the position of the cursor in a specialized
way.  A few of those special purpose positioning are described here,
the others are described in following sections (for a complete list try
@kbd{C-h m}):

@table @kbd

@item .
@efindex .@r{, PO Mode command}
Redisplay the current entry (@code{po-current-entry}).

@item n
@efindex n@r{, PO Mode command}
Select the entry after the current one (@code{po-next-entry}).

@item p
@efindex p@r{, PO Mode command}
Select the entry before the current one (@code{po-previous-entry}).

@item <
@efindex <@r{, PO Mode command}
Select the first entry in the PO file (@code{po-first-entry}).

@item >
@efindex >@r{, PO Mode command}
Select the last entry in the PO file (@code{po-last-entry}).

@item m
@efindex m@r{, PO Mode command}
Record the location of the current entry for later use
(@code{po-push-location}).

@item r
@efindex r@r{, PO Mode command}
Return to a previously saved entry location (@code{po-pop-location}).

@item x
@efindex x@r{, PO Mode command}
Exchange the current entry location with the previously saved one
(@code{po-exchange-location}).

@end table

@efindex .@r{, PO Mode command}
@efindex po-current-entry@r{, PO Mode command}
Any Emacs command able to reposition the cursor may be used
to select the current entry in PO mode, including commands which
move by characters, lines, paragraphs, screens or pages, and search
commands.  However, there is a kind of standard way to display the
current entry in PO mode, which usual Emacs commands moving
the cursor do not especially try to enforce.  The command @kbd{.}
(@code{po-current-entry}) has the sole purpose of redisplaying the
current entry properly, after the current entry has been changed by
means external to PO mode, or the Emacs screen otherwise altered.

It is yet to be decided if PO mode helps the translator, or otherwise
irritates her, by forcing a rigid window disposition while she
is doing her work.  We originally had quite precise ideas about
how windows should behave, but on the other hand, anyone used to
Emacs is often happy to keep full control.  Maybe a fixed window
disposition might be offered as a PO mode option that the translator
might activate or deactivate at will, so it could be offered on an
experimental basis.  If nobody feels a real need for using it, or
a compulsion for writing it, we should drop this whole idea.
The incentive for doing it should come from translators rather than
programmers, as opinions from an experienced translator are surely
more worth to me than opinions from programmers @emph{thinking} about
how @emph{others} should do translation.

@efindex n@r{, PO Mode command}
@efindex po-next-entry@r{, PO Mode command}
@efindex p@r{, PO Mode command}
@efindex po-previous-entry@r{, PO Mode command}
The commands @kbd{n} (@code{po-next-entry}) and @kbd{p}
(@code{po-previous-entry}) move the cursor the entry following,
or preceding, the current one.  If @kbd{n} is given while the
cursor is on the last entry of the PO file, or if @kbd{p}
is given while the cursor is on the first entry, no move is done.

@efindex <@r{, PO Mode command}
@efindex po-first-entry@r{, PO Mode command}
@efindex >@r{, PO Mode command}
@efindex po-last-entry@r{, PO Mode command}
The commands @kbd{<} (@code{po-first-entry}) and @kbd{>}
(@code{po-last-entry}) move the cursor to the first entry, or last
entry, of the PO file.  When the cursor is located past the last
entry in a PO file, most PO mode commands will return an error saying
@samp{After last entry}.  Moreover, the commands @kbd{<} and @kbd{>}
have the special property of being able to work even when the cursor
is not into some PO file entry, and one may use them for nicely
correcting this situation.  But even these commands will fail on a
truly empty PO file.  There are development plans for the PO mode for it
to interactively fill an empty PO file from sources.  @xref{Marking}.

The translator may decide, before working at the translation of
a particular entry, that she needs to browse the remainder of the
PO file, maybe for finding the terminology or phraseology used
in related entries.  She can of course use the standard Emacs idioms
for saving the current cursor location in some register, and use that
register for getting back, or else, use the location ring.

@efindex m@r{, PO Mode command}
@efindex po-push-location@r{, PO Mode command}
@efindex r@r{, PO Mode command}
@efindex po-pop-location@r{, PO Mode command}
PO mode offers another approach, by which cursor locations may be saved
onto a special stack.  The command @kbd{m} (@code{po-push-location})
merely adds the location of current entry to the stack, pushing
the already saved locations under the new one.  The command
@kbd{r} (@code{po-pop-location}) consumes the top stack element and
repositions the cursor to the entry associated with that top element.
This position is then lost, for the next @kbd{r} will move the cursor
to the previously saved location, and so on until no locations remain
on the stack.

If the translator wants the position to be kept on the location stack,
maybe for taking a look at the entry associated with the top
element, then go elsewhere with the intent of getting back later, she
ought to use @kbd{m} immediately after @kbd{r}.

@efindex x@r{, PO Mode command}
@efindex po-exchange-location@r{, PO Mode command}
The command @kbd{x} (@code{po-exchange-location}) simultaneously
repositions the cursor to the entry associated with the top element of
the stack of saved locations, and replaces that top element with the
location of the current entry before the move.  Consequently, repeating
the @kbd{x} command toggles alternatively between two entries.
For achieving this, the translator will position the cursor on the
first entry, use @kbd{m}, then position to the second entry, and
merely use @kbd{x} for making the switch.

@node Normalizing
@subsection Normalizing Strings in Entries
@cindex string normalization in entries

There are many different ways for encoding a particular string into a
PO file entry, because there are so many different ways to split and
quote multi-line strings, and even, to represent special characters
by backslashed escaped sequences.  Some features of PO mode rely on
the ability for PO mode to scan an already existing PO file for a
particular string encoded into the @code{msgid} field of some entry.
Even if PO mode has internally all the built-in machinery for
implementing this recognition easily, doing it fast is technically
difficult.  To facilitate a solution to this efficiency problem,
we decided on a canonical representation for strings.

A conventional representation of strings in a PO file is currently
under discussion, and PO mode experiments with a canonical representation.
Having both @code{xgettext} and PO mode converging towards a uniform
way of representing equivalent strings would be useful, as the internal
normalization needed by PO mode could be automatically satisfied
when using @code{xgettext} from GNU @code{gettext}.  An explicit
PO mode normalization should then be only necessary for PO files
imported from elsewhere, or for when the convention itself evolves.

So, for achieving normalization of at least the strings of a given
PO file needing a canonical representation, the following PO mode
command is available:

@emindex string normalization in entries
@table @kbd
@item M-x po-normalize
@efindex po-normalize@r{, PO Mode command}
Tidy the whole PO file by making entries more uniform.

@end table

The special command @kbd{M-x po-normalize}, which has no associated
keys, revises all entries, ensuring that strings of both original
and translated entries use uniform internal quoting in the PO file.
It also removes any crumb after the last entry.  This command may be
useful for PO files freshly imported from elsewhere, or if we ever
improve on the canonical quoting format we use.  This canonical format
is not only meant for getting cleaner PO files, but also for greatly
speeding up @code{msgid} string lookup for some other PO mode commands.

@kbd{M-x po-normalize} presently makes three passes over the entries.
The first implements heuristics for converting PO files for GNU
@code{gettext} 0.6 and earlier, in which @code{msgid} and @code{msgstr}
fields were using K&R style C string syntax for multi-line strings.
These heuristics may fail for comments not related to obsolete
entries and ending with a backslash; they also depend on subsequent
passes for finalizing the proper commenting of continued lines for
obsolete entries.  This first pass might disappear once all oldish PO
files would have been adjusted.  The second and third pass normalize
all @code{msgid} and @code{msgstr} strings respectively.  They also
clean out those trailing backslashes used by XView's @code{msgfmt}
for continued lines.

@cindex importing PO files
Having such an explicit normalizing command allows for importing PO
files from other sources, but also eases the evolution of the current
convention, evolution driven mostly by aesthetic concerns, as of now.
It is easy to make suggested adjustments at a later time, as the
normalizing command and eventually, other GNU @code{gettext} tools
should greatly automate conformance.  A description of the canonical
string format is given below, for the particular benefit of those not
having Emacs handy, and who would nevertheless want to handcraft
their PO files in nice ways.

@cindex multi-line strings
Right now, in PO mode, strings are single line or multi-line.  A string
goes multi-line if and only if it has @emph{embedded} newlines, that
is, if it matches @samp{[^\n]\n+[^\n]}.  So, we would have:

@example
msgstr "\n\nHello, world!\n\n\n"
@end example

but, replacing the space by a newline, this becomes:

@example
msgstr ""
"\n"
"\n"
"Hello,\n"
"world!\n"
"\n"
"\n"
@end example

We are deliberately using a caricatural example, here, to make the
point clearer.  Usually, multi-lines are not that bad looking.
It is probable that we will implement the following suggestion.
We might lump together all initial newlines into the empty string,
and also all newlines introducing empty lines (that is, for @w{@var{n}
> 1}, the @var{n}-1'th last newlines would go together on a separate
string), so making the previous example appear:

@example
msgstr "\n\n"
"Hello,\n"
"world!\n"
"\n\n"
@end example

There are a few yet undecided little points about string normalization,
to be documented in this manual, once these questions settle.

@node Translated Entries
@subsection Translated Entries
@cindex translated entries

Each PO file entry for which the @code{msgstr} field has been filled with
a translation, and which is not marked as fuzzy (@pxref{Fuzzy Entries}),
is said to be a @dfn{translated} entry.  Only translated entries will
later be compiled by GNU @code{msgfmt} and become usable in programs.
Other entry types will be excluded; translation will not occur for them.

@emindex moving by translated entries
Some commands are more specifically related to translated entry processing.

@table @kbd
@item t
@efindex t@r{, PO Mode command}
Find the next translated entry (@code{po-next-translated-entry}).

@item T
@efindex T@r{, PO Mode command}
Find the previous translated entry (@code{po-previous-translated-entry}).

@end table

@efindex t@r{, PO Mode command}
@efindex po-next-translated-entry@r{, PO Mode command}
@efindex T@r{, PO Mode command}
@efindex po-previous-translated-entry@r{, PO Mode command}
The commands @kbd{t} (@code{po-next-translated-entry}) and @kbd{T}
(@code{po-previous-translated-entry}) move forwards or backwards, chasing
for an translated entry.  If none is found, the search is extended and
wraps around in the PO file buffer.

@evindex po-auto-fuzzy-on-edit@r{, PO Mode variable}
Translated entries usually result from the translator having edited in
a translation for them, @ref{Modifying Translations}.  However, if the
variable @code{po-auto-fuzzy-on-edit} is not @code{nil}, the entry having
received a new translation first becomes a fuzzy entry, which ought to
be later unfuzzied before becoming an official, genuine translated entry.
@xref{Fuzzy Entries}.

@node Fuzzy Entries
@subsection Fuzzy Entries
@cindex fuzzy entries

@cindex attributes of a PO file entry
@cindex attribute, fuzzy
Each PO file entry may have a set of @dfn{attributes}, which are
qualities given a name and explicitly associated with the translation,
using a special system comment.  One of these attributes
has the name @code{fuzzy}, and entries having this attribute are said
to have a fuzzy translation.  They are called fuzzy entries, for short.

Fuzzy entries, even if they account for translated entries for
most other purposes, usually call for revision by the translator.
Those may be produced by applying the program @code{msgmerge} to
update an older translated PO files according to a new PO template
file, when this tool hypothesises that some new @code{msgid} has
been modified only slightly out of an older one, and chooses to pair
what it thinks to be the old translation for the new modified entry.
The slight alteration in the original string (the @code{msgid} string)
should often be reflected in the translated string, and this requires
the intervention of the translator.  For this reason, @code{msgmerge}
might mark some entries as being fuzzy.

@emindex moving by fuzzy entries
Also, the translator may decide herself to mark an entry as fuzzy
for her own convenience, when she wants to remember that the entry
has to be later revisited.  So, some commands are more specifically
related to fuzzy entry processing.

@table @kbd
@item f
@efindex f@r{, PO Mode command}
@c better append "-entry" all the time. -ke-
Find the next fuzzy entry (@code{po-next-fuzzy-entry}).

@item F
@efindex F@r{, PO Mode command}
Find the previous fuzzy entry (@code{po-previous-fuzzy-entry}).

@item @key{TAB}
@efindex TAB@r{, PO Mode command}
Remove the fuzzy attribute of the current entry (@code{po-unfuzzy}).

@end table

@efindex f@r{, PO Mode command}
@efindex po-next-fuzzy-entry@r{, PO Mode command}
@efindex F@r{, PO Mode command}
@efindex po-previous-fuzzy-entry@r{, PO Mode command}
The commands @kbd{f} (@code{po-next-fuzzy-entry}) and @kbd{F}
(@code{po-previous-fuzzy-entry}) move forwards or backwards, chasing for
a fuzzy entry.  If none is found, the search is extended and wraps
around in the PO file buffer.

@efindex TAB@r{, PO Mode command}
@efindex po-unfuzzy@r{, PO Mode command}
@evindex po-auto-select-on-unfuzzy@r{, PO Mode variable}
The command @kbd{@key{TAB}} (@code{po-unfuzzy}) removes the fuzzy
attribute associated with an entry, usually leaving it translated.
Further, if the variable @code{po-auto-select-on-unfuzzy} has not
the @code{nil} value, the @kbd{@key{TAB}} command will automatically chase
for another interesting entry to work on.  The initial value of
@code{po-auto-select-on-unfuzzy} is @code{nil}.

The initial value of @code{po-auto-fuzzy-on-edit} is @code{nil}.  However,
if the variable @code{po-auto-fuzzy-on-edit} is set to @code{t}, any entry
edited through the @kbd{@key{RET}} command is marked fuzzy, as a way to
ensure some kind of double check, later.  In this case, the usual paradigm
is that an entry becomes fuzzy (if not already) whenever the translator
modifies it.  If she is satisfied with the translation, she then uses
@kbd{@key{TAB}} to pick another entry to work on, clearing the fuzzy attribute
on the same blow.  If she is not satisfied yet, she merely uses @kbd{@key{SPC}}
to chase another entry, leaving the entry fuzzy.

@efindex DEL@r{, PO Mode command}
@efindex po-fade-out-entry@r{, PO Mode command}
The translator may also use the @kbd{@key{DEL}} command
(@code{po-fade-out-entry}) over any translated entry to mark it as being
fuzzy, when she wants to easily leave a trace she wants to later return
working at this entry.

Also, when time comes to quit working on a PO file buffer with the @kbd{q}
command, the translator is asked for confirmation, if fuzzy string
still exists.

@node Untranslated Entries
@subsection Untranslated Entries
@cindex untranslated entries

When @code{xgettext} originally creates a PO file, unless told
otherwise, it initializes the @code{msgid} field with the untranslated
string, and leaves the @code{msgstr} string to be empty.  Such entries,
having an empty translation, are said to be @dfn{untranslated} entries.
Later, when the programmer slightly modifies some string right in
the program, this change is later reflected in the PO file
by the appearance of a new untranslated entry for the modified string.

The usual commands moving from entry to entry consider untranslated
entries on the same level as active entries.  Untranslated entries
are easily recognizable by the fact they end with @w{@samp{msgstr ""}}.

@emindex moving by untranslated entries
The work of the translator might be (quite naively) seen as the process
of seeking for an untranslated entry, editing a translation for
it, and repeating these actions until no untranslated entries remain.
Some commands are more specifically related to untranslated entry
processing.

@table @kbd
@item u
@efindex u@r{, PO Mode command}
Find the next untranslated entry (@code{po-next-untranslated-entry}).

@item U
@efindex U@r{, PO Mode command}
Find the previous untranslated entry (@code{po-previous-untransted-entry}).

@item k
@efindex k@r{, PO Mode command}
Turn the current entry into an untranslated one (@code{po-kill-msgstr}).

@end table

@efindex u@r{, PO Mode command}
@efindex po-next-untranslated-entry@r{, PO Mode command}
@efindex U@r{, PO Mode command}
@efindex po-previous-untransted-entry@r{, PO Mode command}
The commands @kbd{u} (@code{po-next-untranslated-entry}) and @kbd{U}
(@code{po-previous-untransted-entry}) move forwards or backwards,
chasing for an untranslated entry.  If none is found, the search is
extended and wraps around in the PO file buffer.

@efindex k@r{, PO Mode command}
@efindex po-kill-msgstr@r{, PO Mode command}
An entry can be turned back into an untranslated entry by
merely emptying its translation, using the command @kbd{k}
(@code{po-kill-msgstr}).  @xref{Modifying Translations}.

Also, when time comes to quit working on a PO file buffer
with the @kbd{q} command, the translator is asked for confirmation,
if some untranslated string still exists.

@node Obsolete Entries
@subsection Obsolete Entries
@cindex obsolete entries

By @dfn{obsolete} PO file entries, we mean those entries which are
commented out, usually by @code{msgmerge} when it found that the
translation is not needed anymore by the package being localized.

The usual commands moving from entry to entry consider obsolete
entries on the same level as active entries.  Obsolete entries are
easily recognizable by the fact that all their lines start with
@code{#}, even those lines containing @code{msgid} or @code{msgstr}.

Commands exist for emptying the translation or reinitializing it
to the original untranslated string.  Commands interfacing with the
kill ring may force some previously saved text into the translation.
The user may interactively edit the translation.  All these commands
may apply to obsolete entries, carefully leaving the entry obsolete
after the fact.

@emindex moving by obsolete entries
Moreover, some commands are more specifically related to obsolete
entry processing.

@table @kbd
@item o
@efindex o@r{, PO Mode command}
Find the next obsolete entry (@code{po-next-obsolete-entry}).

@item O
@efindex O@r{, PO Mode command}
Find the previous obsolete entry (@code{po-previous-obsolete-entry}).

@item @key{DEL}
@efindex DEL@r{, PO Mode command}
Make an active entry obsolete, or zap out an obsolete entry
(@code{po-fade-out-entry}).

@end table

@efindex o@r{, PO Mode command}
@efindex po-next-obsolete-entry@r{, PO Mode command}
@efindex O@r{, PO Mode command}
@efindex po-previous-obsolete-entry@r{, PO Mode command}
The commands @kbd{o} (@code{po-next-obsolete-entry}) and @kbd{O}
(@code{po-previous-obsolete-entry}) move forwards or backwards,
chasing for an obsolete entry.  If none is found, the search is
extended and wraps around in the PO file buffer.

PO mode does not provide ways for un-commenting an obsolete entry
and making it active, because this would reintroduce an original
untranslated string which does not correspond to any marked string
in the program sources.  This goes with the philosophy of never
introducing useless @code{msgid} values.

@efindex DEL@r{, PO Mode command}
@efindex po-fade-out-entry@r{, PO Mode command}
@emindex obsolete active entry
@emindex comment out PO file entry
However, it is possible to comment out an active entry, so making
it obsolete.  GNU @code{gettext} utilities will later react to the
disappearance of a translation by using the untranslated string.
The command @kbd{@key{DEL}} (@code{po-fade-out-entry}) pushes the current entry
a little further towards annihilation.  If the entry is active (it is a
translated entry), then it is first made fuzzy.  If it is already fuzzy,
then the entry is merely commented out, with confirmation.  If the entry
is already obsolete, then it is completely deleted from the PO file.
It is easy to recycle the translation so deleted into some other PO file
entry, usually one which is untranslated.  @xref{Modifying Translations}.

Here is a quite interesting problem to solve for later development of
PO mode, for those nights you are not sleepy.  The idea would be that
PO mode might become bright enough, one of these days, to make good
guesses at retrieving the most probable candidate, among all obsolete
entries, for initializing the translation of a newly appeared string.
I think it might be a quite hard problem to do this algorithmically, as
we have to develop good and efficient measures of string similarity.
Right now, PO mode completely lets the decision to the translator,
when the time comes to find the adequate obsolete translation, it
merely tries to provide handy tools for helping her to do so.

@node Modifying Translations
@subsection Modifying Translations
@cindex editing translations
@emindex editing translations

PO mode prevents direct modification of the PO file, by the usual
means Emacs gives for altering a buffer's contents.  By doing so,
it pretends helping the translator to avoid little clerical errors
about the overall file format, or the proper quoting of strings,
as those errors would be easily made.  Other kinds of errors are
still possible, but some may be caught and diagnosed by the batch
validation process, which the translator may always trigger by the
@kbd{V} command.  For all other errors, the translator has to rely on
her own judgment, and also on the linguistic reports submitted to her
by the users of the translated package, having the same mother tongue.

When the time comes to create a translation, correct an error diagnosed
mechanically or reported by a user, the translators have to resort to
using the following commands for modifying the translations.

@table @kbd
@item @key{RET}
@efindex RET@r{, PO Mode command}
Interactively edit the translation (@code{po-edit-msgstr}).

@item @key{LFD}
@itemx C-j
@efindex LFD@r{, PO Mode command}
@efindex C-j@r{, PO Mode command}
Reinitialize the translation with the original, untranslated string
(@code{po-msgid-to-msgstr}).

@item k
@efindex k@r{, PO Mode command}
Save the translation on the kill ring, and delete it (@code{po-kill-msgstr}).

@item w
@efindex w@r{, PO Mode command}
Save the translation on the kill ring, without deleting it
(@code{po-kill-ring-save-msgstr}).

@item y
@efindex y@r{, PO Mode command}
Replace the translation, taking the new from the kill ring
(@code{po-yank-msgstr}).

@end table

@efindex RET@r{, PO Mode command}
@efindex po-edit-msgstr@r{, PO Mode command}
The command @kbd{@key{RET}} (@code{po-edit-msgstr}) opens a new Emacs
window meant to edit in a new translation, or to modify an already existing
translation.  The new window contains a copy of the translation taken from
the current PO file entry, all ready for edition, expunged of all quoting
marks, fully modifiable and with the complete extent of Emacs modifying
commands.  When the translator is done with her modifications, she may use
@w{@kbd{C-c C-c}} to close the subedit window with the automatically requoted
results, or @w{@kbd{C-c C-k}} to abort her modifications.  @xref{Subedit},
for more information.

@efindex LFD@r{, PO Mode command}
@efindex C-j@r{, PO Mode command}
@efindex po-msgid-to-msgstr@r{, PO Mode command}
The command @kbd{@key{LFD}} (@code{po-msgid-to-msgstr}) initializes, or
reinitializes the translation with the original string.  This command is
normally used when the translator wants to redo a fresh translation of
the original string, disregarding any previous work.

@evindex po-auto-edit-with-msgid@r{, PO Mode variable}
It is possible to arrange so, whenever editing an untranslated
entry, the @kbd{@key{LFD}} command be automatically executed.  If you set
@code{po-auto-edit-with-msgid} to @code{t}, the translation gets
initialised with the original string, in case none exists already.
The default value for @code{po-auto-edit-with-msgid} is @code{nil}.

@emindex starting a string translation
In fact, whether it is best to start a translation with an empty
string, or rather with a copy of the original string, is a matter of
taste or habit.  Sometimes, the source language and the
target language are so different that is simply best to start writing
on an empty page.  At other times, the source and target languages
are so close that it would be a waste to retype a number of words
already being written in the original string.  A translator may also
like having the original string right under her eyes, as she will
progressively overwrite the original text with the translation, even
if this requires some extra editing work to get rid of the original.

@emindex cut and paste for translated strings
@efindex k@r{, PO Mode command}
@efindex po-kill-msgstr@r{, PO Mode command}
@efindex w@r{, PO Mode command}
@efindex po-kill-ring-save-msgstr@r{, PO Mode command}
The command @kbd{k} (@code{po-kill-msgstr}) merely empties the
translation string, so turning the entry into an untranslated
one.  But while doing so, its previous contents is put apart in
a special place, known as the kill ring.  The command @kbd{w}
(@code{po-kill-ring-save-msgstr}) has also the effect of taking a
copy of the translation onto the kill ring, but it otherwise leaves
the entry alone, and does @emph{not} remove the translation from the
entry.  Both commands use exactly the Emacs kill ring, which is shared
between buffers, and which is well known already to Emacs lovers.

The translator may use @kbd{k} or @kbd{w} many times in the course
of her work, as the kill ring may hold several saved translations.
From the kill ring, strings may later be reinserted in various
Emacs buffers.  In particular, the kill ring may be used for moving
translation strings between different entries of a single PO file
buffer, or if the translator is handling many such buffers at once,
even between PO files.

To facilitate exchanges with buffers which are not in PO mode, the
translation string put on the kill ring by the @kbd{k} command is fully
unquoted before being saved: external quotes are removed, multi-line
strings are concatenated, and backslash escaped sequences are turned
into their corresponding characters.  In the special case of obsolete
entries, the translation is also uncommented prior to saving.

@efindex y@r{, PO Mode command}
@efindex po-yank-msgstr@r{, PO Mode command}
The command @kbd{y} (@code{po-yank-msgstr}) completely replaces the
translation of the current entry by a string taken from the kill ring.
Following Emacs terminology, we then say that the replacement
string is @dfn{yanked} into the PO file buffer.
@xref{Yanking, , , emacs, The Emacs Editor}.
The first time @kbd{y} is used, the translation receives the value of
the most recent addition to the kill ring.  If @kbd{y} is typed once
again, immediately, without intervening keystrokes, the translation
just inserted is taken away and replaced by the second most recent
addition to the kill ring.  By repeating @kbd{y} many times in a row,
the translator may travel along the kill ring for saved strings,
until she finds the string she really wanted.

When a string is yanked into a PO file entry, it is fully and
automatically requoted for complying with the format PO files should
have.  Further, if the entry is obsolete, PO mode then appropriately
push the inserted string inside comments.  Once again, translators
should not burden themselves with quoting considerations besides, of
course, the necessity of the translated string itself respective to
the program using it.

Note that @kbd{k} or @kbd{w} are not the only commands pushing strings
on the kill ring, as almost any PO mode command replacing translation
strings (or the translator comments) automatically saves the old string
on the kill ring.  The main exceptions to this general rule are the
yanking commands themselves.

@emindex using obsolete translations to make new entries
To better illustrate the operation of killing and yanking, let's
use an actual example, taken from a common situation.  When the
programmer slightly modifies some string right in the program, his
change is later reflected in the PO file by the appearance
of a new untranslated entry for the modified string, and the fact
that the entry translating the original or unmodified string becomes
obsolete.  In many cases, the translator might spare herself some work
by retrieving the unmodified translation from the obsolete entry,
then initializing the untranslated entry @code{msgstr} field with
this retrieved translation.  Once this done, the obsolete entry is
not wanted anymore, and may be safely deleted.

When the translator finds an untranslated entry and suspects that a
slight variant of the translation exists, she immediately uses @kbd{m}
to mark the current entry location, then starts chasing obsolete
entries with @kbd{o}, hoping to find some translation corresponding
to the unmodified string.  Once found, she uses the @kbd{@key{DEL}} command
for deleting the obsolete entry, knowing that @kbd{@key{DEL}} also @emph{kills}
the translation, that is, pushes the translation on the kill ring.
Then, @kbd{r} returns to the initial untranslated entry, and @kbd{y}
then @emph{yanks} the saved translation right into the @code{msgstr}
field.  The translator is then free to use @kbd{@key{RET}} for fine
tuning the translation contents, and maybe to later use @kbd{u},
then @kbd{m} again, for going on with the next untranslated string.

When some sequence of keys has to be typed over and over again, the
translator may find it useful to become better acquainted with the Emacs
capability of learning these sequences and playing them back under request.
@xref{Keyboard Macros, , , emacs, The Emacs Editor}.

@node Modifying Comments
@subsection Modifying Comments
@cindex editing comments in PO files
@emindex editing comments

Any translation work done seriously will raise many linguistic
difficulties, for which decisions have to be made, and the choices
further documented.  These documents may be saved within the
PO file in form of translator comments, which the translator
is free to create, delete, or modify at will.  These comments may
be useful to herself when she returns to this PO file after a while.

Comments not having whitespace after the initial @samp{#}, for example,
those beginning with @samp{#.} or @samp{#:}, are @emph{not} translator
comments, they are exclusively created by other @code{gettext} tools.
So, the commands below will never alter such system added comments,
they are not meant for the translator to modify.
@xref{PO Files, , , gettext, GNU gettext tools}.

The following commands are somewhat similar to those modifying translations,
so the general indications given for those apply here.  @xref{Modifying
Translations}.

@table @kbd

@item #
@efindex #@r{, PO Mode command}
Interactively edit the translator comments (@code{po-edit-comment}).

@item K
@efindex K@r{, PO Mode command}
Save the translator comments on the kill ring, and delete it
(@code{po-kill-comment}).

@item W
@efindex W@r{, PO Mode command}
Save the translator comments on the kill ring, without deleting it
(@code{po-kill-ring-save-comment}).

@item Y
@efindex Y@r{, PO Mode command}
Replace the translator comments, taking the new from the kill ring
(@code{po-yank-comment}).

@end table

These commands parallel PO mode commands for modifying the translation
strings, and behave much the same way as they do, except that they handle
this part of PO file comments meant for translator usage, rather
than the translation strings.  So, if the descriptions given below are
slightly succinct, it is because the full details have already been given.
@xref{Modifying Translations}.

@efindex #@r{, PO Mode command}
@efindex po-edit-comment@r{, PO Mode command}
The command @kbd{#} (@code{po-edit-comment}) opens a new Emacs window
containing a copy of the translator comments on the current PO file entry.
If there are no such comments, PO mode understands that the translator wants
to add a comment to the entry, and she is presented with an empty screen.
Comment marks (@code{#}) and the space following them are automatically
removed before edition, and reinstated after.  For translator comments
pertaining to obsolete entries, the uncommenting and recommenting operations
are done twice.  Once in the editing window, the keys @w{@kbd{C-c C-c}}
allow the translator to tell she is finished with editing the comment.
@xref{Subedit}, for further details.

@evindex po-subedit-mode-hook@r{, PO Mode variable}
Functions found on @code{po-subedit-mode-hook}, if any, are executed after
the string has been inserted in the edit buffer.

@efindex K@r{, PO Mode command}
@efindex po-kill-comment@r{, PO Mode command}
@efindex W@r{, PO Mode command}
@efindex po-kill-ring-save-comment@r{, PO Mode command}
@efindex Y@r{, PO Mode command}
@efindex po-yank-comment@r{, PO Mode command}
The command @kbd{K} (@code{po-kill-comment}) gets rid of all
translator comments, while saving those comments on the kill ring.
The command @kbd{W} (@code{po-kill-ring-save-comment}) takes
a copy of the translator comments on the kill ring, but leaves
them undisturbed in the current entry.  The command @kbd{Y}
(@code{po-yank-comment}) completely replaces the translator comments
by a string taken at the front of the kill ring.  When this command
is immediately repeated, the comments just inserted are withdrawn,
and replaced by other strings taken along the kill ring.

On the kill ring, all strings have the same nature.  There is no
distinction between @emph{translation} strings and @emph{translator
comments} strings.  So, for example, let's presume the translator
has just finished editing a translation, and wants to create a new
translator comment to document why the previous translation was
not good, just to remember what was the problem.  Foreseeing that she
will do that in her documentation, the translator may want to quote
the previous translation in her translator comments.  To do so, she
may initialize the translator comments with the previous translation,
still at the head of the kill ring.  Because editing already pushed the
previous translation on the kill ring, she merely has to type @kbd{M-w}
prior to @kbd{#}, and the previous translation will be right there,
all ready for being introduced by some explanatory text.

On the other hand, presume there are some translator comments already
and that the translator wants to add to those comments, instead
of wholly replacing them.  Then, she should edit the comment right
away with @kbd{#}.  Once inside the editing window, she can use the
regular Emacs commands @kbd{C-y} (@code{yank}) and @kbd{M-y}
(@code{yank-pop}) to get the previous translation where she likes.

@node Subedit
@subsection Details of Sub Edition
@emindex subedit minor mode

The PO subedit minor mode has a few peculiarities worth being described
in fuller detail.  It installs a few commands over the usual editing set
of Emacs, which are described below.

@table @kbd
@item C-c C-c
@efindex C-c C-c@r{, PO Mode command}
Complete edition (@code{po-subedit-exit}).

@item C-c C-k
@efindex C-c C-k@r{, PO Mode command}
Abort edition (@code{po-subedit-abort}).

@item C-c C-a
@efindex C-c C-a@r{, PO Mode command}
Consult auxiliary PO files (@code{po-subedit-cycle-auxiliary}).

@end table

@emindex exiting PO subedit
@efindex C-c C-c@r{, PO Mode command}
@efindex po-subedit-exit@r{, PO Mode command}
The window's contents represents a translation for a given message,
or a translator comment.  The translator may modify this window to
her heart's content.  Once this is done, the command @w{@kbd{C-c C-c}}
(@code{po-subedit-exit}) may be used to return the edited translation into
the PO file, replacing the original translation, even if it moved out of
sight or if buffers were switched.

@efindex C-c C-k@r{, PO Mode command}
@efindex po-subedit-abort@r{, PO Mode command}
If the translator becomes unsatisfied with her translation or comment,
to the extent she prefers keeping what was existent prior to the
@kbd{@key{RET}} or @kbd{#} command, she may use the command @w{@kbd{C-c C-k}}
(@code{po-subedit-abort}) to merely get rid of edition, while preserving
the original translation or comment.  Another way would be for her to exit
normally with @w{@kbd{C-c C-c}}, then type @code{U} once for undoing the
whole effect of last edition.

@efindex C-c C-a@r{, PO Mode command}
@efindex po-subedit-cycle-auxiliary@r{, PO Mode command}
The command @w{@kbd{C-c C-a}} (@code{po-subedit-cycle-auxiliary})
allows for glancing through translations
already achieved in other languages, directly while editing the current
translation.  This may be quite convenient when the translator is fluent
at many languages, but of course, only makes sense when such completed
auxiliary PO files are already available to her (@pxref{Auxiliary}).

Functions found on @code{po-subedit-mode-hook}, if any, are executed after
the string has been inserted in the edit buffer.

While editing her translation, the translator should pay attention to not
inserting unwanted @kbd{@key{RET}} (newline) characters at the end of
the translated string if those are not meant to be there, or to removing
such characters when they are required.  Since these characters are not
visible in the editing buffer, they are easily introduced by mistake.
To help her, @kbd{@key{RET}} automatically puts the character @code{<}
at the end of the string being edited, but this @code{<} is not really
part of the string.  On exiting the editing window with @w{@kbd{C-c C-c}},
PO mode automatically removes such @kbd{<} and all whitespace added after
it.  If the translator adds characters after the terminating @code{<}, it
looses its delimiting property and integrally becomes part of the string.
If she removes the delimiting @code{<}, then the edited string is taken
@emph{as is}, with all trailing newlines, even if invisible.  Also, if
the translated string ought to end itself with a genuine @code{<}, then
the delimiting @code{<} may not be removed; so the string should appear,
in the editing window, as ending with two @code{<} in a row.

@emindex editing multiple entries
When a translation (or a comment) is being edited, the translator may move
the cursor back into the PO file buffer and freely move to other entries,
browsing at will.  If, with an edition pending, the translator wanders in the
PO file buffer, she may decide to start modifying another entry.  Each entry
being edited has its own subedit buffer.  It is possible to simultaneously
edit the translation @emph{and} the comment of a single entry, or to
edit entries in different PO files, all at once.  Typing @kbd{@key{RET}}
on a field already being edited merely resumes that particular edit.  Yet,
the translator should better be comfortable at handling many Emacs windows!

@emindex pending subedits
Pending subedits may be completed or aborted in any order, regardless
of how or when they were started.  When many subedits are pending and the
translator asks for quitting the PO file (with the @kbd{q} command), subedits
are automatically resumed one at a time, so she may decide for each of them.

@node C Sources Context
@subsection C Sources Context
@emindex consulting program sources
@emindex looking at the source to aid translation
@emindex use the source, Luke

PO mode is particularly powerful when used with PO files
created through GNU @code{gettext} utilities, as those utilities
insert special comments in the PO files they generate.
Some of these special comments relate the PO file entry to
exactly where the untranslated string appears in the program sources.

When the translator gets to an untranslated entry, she is fairly
often faced with an original string which is not as informative as
it normally should be, being succinct, cryptic, or otherwise ambiguous.
Before choosing how to translate the string, she needs to understand
better what the string really means and how tight the translation has
to be.  Most of the time, when problems arise, the only way left to make
her judgment is looking at the true program sources from where this
string originated, searching for surrounding comments the programmer
might have put in there, and looking around for helping clues of
@emph{any} kind.

Surely, when looking at program sources, the translator will receive
more help if she is a fluent programmer.  However, even if she is
not versed in programming and feels a little lost in C code, the
translator should not be shy at taking a look, once in a while.
It is most probable that she will still be able to find some of the
hints she needs.  She will learn quickly to not feel uncomfortable
in program code, paying more attention to programmer's comments,
variable and function names (if he dared choosing them well), and
overall organization, than to the program code itself.

@emindex find source fragment for a PO file entry
The following commands are meant to help the translator at getting
program source context for a PO file entry.

@table @kbd
@item s
@efindex s@r{, PO Mode command}
Resume the display of a program source context, or cycle through them
(@code{po-cycle-source-reference}).

@item M-s
@efindex M-s@r{, PO Mode command}
Display of a program source context selected by menu
(@code{po-select-source-reference}).

@item S
@efindex S@r{, PO Mode command}
Add a directory to the search path for source files
(@code{po-consider-source-path}).

@item M-S
@efindex M-S@r{, PO Mode command}
Delete a directory from the search path for source files
(@code{po-ignore-source-path}).

@end table

@efindex s@r{, PO Mode command}
@efindex po-cycle-source-reference@r{, PO Mode command}
@efindex M-s@r{, PO Mode command}
@efindex po-select-source-reference@r{, PO Mode command}
The commands @kbd{s} (@code{po-cycle-source-reference}) and @kbd{M-s}
(@code{po-select-source-reference}) both open another window displaying
some source program file, and already positioned in such a way that
it shows an actual use of the string to be translated.  By doing
so, the command gives source program context for the string.  But if
the entry has no source context references, or if all references
are unresolved along the search path for program sources, then the
command diagnoses this as an error.

Even if @kbd{s} (or @kbd{M-s}) opens a new window, the cursor stays
in the PO file window.  If the translator really wants to
get into the program source window, she ought to do it explicitly,
maybe by using command @kbd{O}.

When @kbd{s} is typed for the first time, or for a PO file entry which
is different of the last one used for getting source context, then the
command reacts by giving the first context available for this entry,
if any.  If some context has already been recently displayed for the
current PO file entry, and the translator wandered off to do other
things, typing @kbd{s} again will merely resume, in another window,
the context last displayed.  In particular, if the translator moved
the cursor away from the context in the source file, the command will
bring the cursor back to the context.  By using @kbd{s} many times
in a row, with no other commands intervening, PO mode will cycle to
the next available contexts for this particular entry, getting back
to the first context once the last has been shown.

The command @kbd{M-s} behaves differently.  Instead of cycling through
references, it lets the translator choose a particular reference among
many, and displays that reference.  It is best used with completion,
if the translator types @kbd{@key{TAB}} immediately after @kbd{M-s}, in
response to the question, she will be offered a menu of all possible
references, as a reminder of which are the acceptable answers.
This command is useful only where there are really many contexts
available for a single string to translate.

@efindex S@r{, PO Mode command}
@efindex po-consider-source-path@r{, PO Mode command}
@efindex M-S@r{, PO Mode command}
@efindex po-ignore-source-path@r{, PO Mode command}
Program source files are usually found relative to where the PO
file stands.  As a special provision, when this fails, the file is
also looked for, but relative to the directory immediately above it.
Those two cases take proper care of most PO files.  However, it might
happen that a PO file has been moved, or is edited in a different
place than its normal location.  When this happens, the translator
should tell PO mode in which directory normally sits the genuine PO
file.  Many such directories may be specified, and all together, they
constitute what is called the @dfn{search path} for program sources.
The command @kbd{S} (@code{po-consider-source-path}) is used to interactively
enter a new directory at the front of the search path, and the command
@kbd{M-S} (@code{po-ignore-source-path}) is used to select, with completion,
one of the directories she does not want anymore on the search path.

@node Auxiliary
@subsection Consulting Auxiliary PO Files
@emindex consulting translations to other languages

PO mode is able to help the knowledgeable translator, being fluent in
many languages, at taking advantage of translations already achieved
in other languages she just happens to know.  It provides these other
language translations as additional context for her own work.  Moreover,
it has features to ease the production of translations for many languages
at once, for translators preferring to work in this way.

@cindex auxiliary PO file
@emindex auxiliary PO file
An @dfn{auxiliary} PO file is an existing PO file meant for the same
package the translator is working on, but targeted to a different mother
tongue language.  Commands exist for declaring and handling auxiliary
PO files, and also for showing contexts for the entry under work.

Here are the auxiliary file commands available in PO mode.

@table @kbd
@item a
@efindex a@r{, PO Mode command}
Seek auxiliary files for another translation for the same entry
(@code{po-cycle-auxiliary}).

@item C-c C-a
@efindex C-c C-a@r{, PO Mode command}
Switch to a particular auxiliary file (@code{po-select-auxiliary}).

@item A
@efindex A@r{, PO Mode command}
Declare this PO file as an auxiliary file (@code{po-consider-as-auxiliary}).

@item M-A
@efindex M-A@r{, PO Mode command}
Remove this PO file from the list of auxiliary files
(@code{po-ignore-as-auxiliary}).

@end table

@efindex A@r{, PO Mode command}
@efindex po-consider-as-auxiliary@r{, PO Mode command}
@efindex M-A@r{, PO Mode command}
@efindex po-ignore-as-auxiliary@r{, PO Mode command}
Command @kbd{A} (@code{po-consider-as-auxiliary}) adds the current
PO file to the list of auxiliary files, while command @kbd{M-A}
(@code{po-ignore-as-auxiliary} just removes it.

@efindex a@r{, PO Mode command}
@efindex po-cycle-auxiliary@r{, PO Mode command}
The command @kbd{a} (@code{po-cycle-auxiliary}) seeks all auxiliary PO
files, round-robin, searching for a translated entry in some other language
having an @code{msgid} field identical as the one for the current entry.
The found PO file, if any, takes the place of the current PO file in
the display (its window gets on top).  Before doing so, the current PO
file is also made into an auxiliary file, if not already.  So, @kbd{a}
in this newly displayed PO file will seek another PO file, and so on,
so repeating @kbd{a} will eventually yield back the original PO file.

@efindex C-c C-a@r{, PO Mode command}
@efindex po-select-auxiliary@r{, PO Mode command}
The command @kbd{C-c C-a} (@code{po-select-auxiliary}) asks the translator
for her choice of a particular auxiliary file, with completion, and
then switches to that selected PO file.  The command also checks if
the selected file has an @code{msgid} field identical as the one for
the current entry, and if yes, this entry becomes current.  Otherwise,
the cursor of the selected file is left undisturbed.

For all this to work fully, auxiliary PO files will have to be normalized,
in that way that @code{msgid} fields should be written @emph{exactly}
the same way.  It is possible to write @code{msgid} fields in various
ways for representing the same string, different writing would break the
proper behaviour of the auxiliary file commands of PO mode.  This is not
expected to be much a problem in practice, as most existing PO files have
their @code{msgid} entries written by the same GNU @code{gettext} tools.

@efindex normalize@r{, PO Mode command}
However, PO files initially created by PO mode itself, while marking
strings in source files, are normalised differently.  So are PO
files resulting of the @samp{M-x normalize} command.  Until these
discrepancies between PO mode and other GNU @code{gettext} tools get
fully resolved, the translator should stay aware of normalisation issues.

@node Programmers
@chapter PO mode for programmers

In PO mode, one set of features is meant more for the programmer than
for the translator, and allows him to interactively mark which strings,
in a set of program sources, are translatable, and which are not.
Even if it is a fairly easy job for a programmer to find and mark
such strings by other means, using any editor of his choice, PO mode
makes this work more comfortable.  Further, this gives translators
who feel a little like programmers, or programmers who feel a little
like translators, a tool letting them work at marking translatable
strings in the program sources, while simultaneously producing a set of
translation in some language, for the package being internationalized.

@menu
* Marking::                     Marking Translatable Strings
@end menu

@node Marking
@section Marking Translatable Strings
@emindex marking strings for translation

@emindex @code{etags}, using for marking strings
The set of program sources, targeted by the PO mode commands describe
here, should have an Emacs tags table constructed for your project,
prior to using these PO file commands.  This is easy to do.  In any
shell window, change the directory to the root of your project, then
execute a command resembling:

@example
etags src/*.[hc] lib/*.[hc]
@end example

@noindent
presuming here you want to process all @file{.h} and @file{.c} files
from the @file{src/} and @file{lib/} directories.  This command will
explore all said files and create a @file{TAGS} file in your root
directory, somewhat summarizing the contents using a special file
format Emacs can understand.

@emindex @file{TAGS}, and marking translatable strings
For packages following the GNU coding standards, there is
a make goal @code{tags} or @code{TAGS} which constructs the tag files in
all directories and for all files containing source code.

Once your @file{TAGS} file is ready, the following commands assist
the programmer at marking translatable strings in his set of sources.
But these commands are necessarily driven from within a PO file
window, and it is likely that you do not even have such a PO file yet.
This is not a problem at all, as you may safely open a new, empty PO
file, mainly for using these commands.  This empty PO file will slowly
fill in while you mark strings as translatable in your program sources.

@table @kbd
@item ,
@efindex ,@r{, PO Mode command}
Search through program sources for a string which looks like a
candidate for translation (@code{po-tags-search}).

@item M-,
@efindex M-,@r{, PO Mode command}
Mark the last string found with @samp{_()} (@code{po-mark-translatable}).

@item M-.
@efindex M-.@r{, PO Mode command}
Mark the last string found with a keyword taken from a set of possible
keywords.  This command with a prefix allows some management of these
keywords (@code{po-select-mark-and-mark}).

@end table

@efindex po-tags-search@r{, PO Mode command}
The @kbd{,} (@code{po-tags-search}) command searches for the next
occurrence of a string which looks like a possible candidate for
translation, and displays the program source in another Emacs window,
positioned in such a way that the string is near the top of this other
window.  If the string is too big to fit whole in this window, it is
positioned so only its end is shown.  In any case, the cursor
is left in the PO file window.  If the shown string would be better
presented differently in different native languages, you may mark it
using @kbd{M-,} or @kbd{M-.}.  Otherwise, you might rather ignore it
and skip to the next string by merely repeating the @kbd{,} command.

A string is a good candidate for translation if it contains a sequence
of three or more letters.  A string containing at most two letters in
a row will be considered as a candidate if it has more letters than
non-letters.  The command disregards strings containing no letters,
or isolated letters only.  It also disregards strings within comments,
or strings already marked with some keyword PO mode knows (see below).

If you have never told Emacs about some @file{TAGS} file to use, the
command will request that you specify one from the minibuffer, the
first time you use the command.  You may later change your @file{TAGS}
file by using the regular Emacs command @w{@kbd{M-x visit-tags-table}},
which will ask you to name the precise @file{TAGS} file you want
to use.  @xref{Tags, , Tag Tables, emacs, The Emacs Editor}.

Each time you use the @kbd{,} command, the search resumes from where it was
left by the previous search, and goes through all program sources,
obeying the @file{TAGS} file, until all sources have been processed.
However, by giving a prefix argument to the command @w{(@kbd{C-u
,})}, you may request that the search be restarted all over again
from the first program source; but in this case, strings that you
recently marked as translatable will be automatically skipped.

Using this @kbd{,} command does not prevent using of other regular
Emacs tags commands.  For example, regular @code{tags-search} or
@code{tags-query-replace} commands may be used without disrupting the
independent @kbd{,} search sequence.  However, as implemented, the
@emph{initial} @kbd{,} command (or the @kbd{,} command is used with a
prefix) might also reinitialize the regular Emacs tags searching to the
first tags file, this reinitialization might be considered spurious.

@efindex po-mark-translatable@r{, PO Mode command}
@efindex po-select-mark-and-mark@r{, PO Mode command}
The @kbd{M-,} (@code{po-mark-translatable}) command will mark the
recently found string with the @samp{_} keyword.  The @kbd{M-.}
(@code{po-select-mark-and-mark}) command will request that you type
one keyword from the minibuffer and use that keyword for marking
the string.  Both commands will automatically create a new PO file
untranslated entry for the string being marked, and make it the
current entry (making it easy for you to immediately proceed to its
translation, if you feel like doing it right away).  It is possible
that the modifications made to the program source by @kbd{M-,} or
@kbd{M-.} render some source line longer than 80 columns, forcing you
to break and re-indent this line differently.  You may use the @kbd{O}
command from PO mode, or any other window changing command from
Emacs, to break out into the program source window, and do any
needed adjustments.  You will have to use some regular Emacs command
to return the cursor to the PO file window, if you want command
@kbd{,} for the next string, say.

The @kbd{M-.} command has a few built-in speedups, so you do not
have to explicitly type all keywords all the time.  The first such
speedup is that you are presented with a @emph{preferred} keyword,
which you may accept by merely typing @kbd{@key{RET}} at the prompt.
The second speedup is that you may type any non-ambiguous prefix of the
keyword you really mean, and the command will complete it automatically
for you.  This also means that PO mode has to @emph{know} all
your possible keywords, and that it will not accept mistyped keywords.

If you reply @kbd{?} to the keyword request, the command gives a
list of all known keywords, from which you may choose.  When the
command is prefixed by an argument @w{(@kbd{C-u M-.})}, it inhibits
updating any program source or PO file buffer, and does some simple
keyword management instead.  In this case, the command asks for a
keyword, written in full, which becomes a new allowed keyword for
later @kbd{M-.} commands.  Moreover, this new keyword automatically
becomes the @emph{preferred} keyword for later commands.  By typing
an already known keyword in response to @w{@kbd{C-u M-.}}, one merely
changes the @emph{preferred} keyword and does nothing more.

All keywords known for @kbd{M-.} are recognized by the @kbd{,} command
when scanning for strings, and strings already marked by any of those
known keywords are automatically skipped.  If many PO files are opened
simultaneously, each one has its own independent set of known keywords.
There is no provision in PO mode, currently, for deleting a known
keyword, you have to quit the file (maybe using @kbd{q}) and reopen
it afresh.  When a PO file is newly brought up in an Emacs window, only
@samp{gettext} and @samp{_} are known as keywords, and @samp{gettext}
is preferred for the @kbd{M-.} command.  In fact, this is not useful to
prefer @samp{_}, as this one is already built in the @kbd{M-,} command.

@node Licenses
@appendix Licenses
@cindex Licenses

The files of this package are covered by the licenses indicated in each
particular file or directory.  Here is a summary:

@itemize @bullet
@item
The PO mode's code is covered by the GNU General Public License (GPL).
A copy of the license is included in @ref{GNU GPL}.

@item
This manual is free documentation.  It is dually licensed under the
GNU FDL and the GNU GPL.  This means that you can redistribute this
manual under either of these two licenses, at your choice.
@*
This manual is covered by the GNU FDL.  Permission is granted to copy,
distribute and/or modify this document under the terms of the
GNU Free Documentation License (FDL), either version 1.2 of the
License, or (at your option) any later version published by the
Free Software Foundation (FSF); with no Invariant Sections, with no
Front-Cover Text, and with no Back-Cover Texts.
A copy of the license is included in @ref{GNU FDL}.
@*
This manual is covered by the GNU GPL.  You can redistribute it and/or
modify it under the terms of the GNU General Public License (GPL), either
version 2 of the License, or (at your option) any later version published
by the Free Software Foundation (FSF).
A copy of the license is included in @ref{GNU GPL}.
@end itemize

@menu
* GNU GPL::                     GNU General Public License
* GNU FDL::                     GNU Free Documentation License
@end menu

@page
@node GNU GPL
@appendixsec GNU GENERAL PUBLIC LICENSE
@cindex GPL, GNU General Public License
@cindex License, GNU GPL
@include gpl.texi
@page
@node GNU FDL
@appendixsec GNU Free Documentation License
@cindex FDL, GNU Free Documentation License
@cindex License, GNU FDL
@include fdl.texi

@node PO Mode Index
@unnumbered PO Mode Index

@printindex em

@node Index
@unnumbered General Index

@printindex cp

@bye

@c Local variables:
@c texinfo-column-for-description: 32
@c End:
